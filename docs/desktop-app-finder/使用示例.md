# Android æ¡Œé¢åº”ç”¨æŸ¥æ‰¾ä¸å¯åŠ¨ - ä½¿ç”¨ç¤ºä¾‹

## æ¦‚è¿°

æœ¬é¡¹ç›®æä¾›äº†ä¸¤ä¸ªè„šæœ¬æ¥å®ç°åœ¨ Android è®¾å¤‡æ¡Œé¢ä¸Šæ™ºèƒ½æŸ¥æ‰¾å¹¶å¯åŠ¨åº”ç”¨çš„åŠŸèƒ½ï¼š

1. **demo-open-close-settings.sh** - ä¸“é—¨ç”¨äºè®¾ç½®åº”ç”¨çš„å®Œæ•´æ¼”ç¤º
2. **find-and-launch-app.sh** - é€šç”¨è„šæœ¬ï¼Œå¯æŸ¥æ‰¾ä»»æ„åº”ç”¨

## è„šæœ¬ 1: demo-open-close-settings.sh

### åŠŸèƒ½ç‰¹ç‚¹

- âœ… è‡ªåŠ¨è¿”å›ä¸»å±å¹•
- âœ… æ™ºèƒ½æŸ¥æ‰¾è®¾ç½®åº”ç”¨å›¾æ ‡
- âœ… æ”¯æŒå·¦å³æ»‘åŠ¨æŸ¥æ‰¾ï¼ˆæœ€å¤šå„ 5 æ¬¡ï¼‰
- âœ… ç‚¹å‡»å›¾æ ‡å¯åŠ¨åº”ç”¨
- âœ… æˆªå–åº”ç”¨ç•Œé¢
- âœ… è‡ªåŠ¨å…³é—­åº”ç”¨
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†

### ä½¿ç”¨æ–¹æ³•

```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x demo-open-close-settings.sh

# è¿è¡Œè„šæœ¬
./demo-open-close-settings.sh
```

### æ‰§è¡Œæµç¨‹

```
1. æ£€æŸ¥è®¾å¤‡è¿æ¥
2. è¿”å›ä¸»å±å¹•
3. æŸ¥æ‰¾è®¾ç½®å›¾æ ‡ï¼ˆæ”¯æŒæ»‘åŠ¨ï¼‰
4. ç‚¹å‡»å›¾æ ‡å¯åŠ¨
5. æˆªå–å±å¹•
6. ç­‰å¾… 3 ç§’
7. å…³é—­åº”ç”¨
8. è¿”å›ä¸»å±å¹•
```

### è¾“å‡ºç¤ºä¾‹

```
ğŸš€ å¼€å§‹æ¼”ç¤ºï¼šåœ¨æ¡Œé¢æŸ¥æ‰¾å¹¶æ‰“å¼€è®¾ç½®åº”ç”¨

ğŸ“± æ£€æŸ¥è¿æ¥çš„è®¾å¤‡...
âœ… æ‰¾åˆ°è®¾å¤‡: d2244420

ğŸ“± è®¾å¤‡å‹å·: 25098PN5AC
ğŸ¤– Android ç‰ˆæœ¬: 16

ğŸ  æ­¥éª¤ 1: è¿”å›ä¸»å±å¹•...
âœ… å·²è¿”å›ä¸»å±å¹•

ğŸ” æ­¥éª¤ 2: åœ¨æ¡Œé¢ä¸ŠæŸ¥æ‰¾è®¾ç½®åº”ç”¨å›¾æ ‡...
âœ… åœ¨å½“å‰é¡µé¢æ‰¾åˆ°è®¾ç½®å›¾æ ‡

ğŸ‘† æ­¥éª¤ 3: ç‚¹å‡»è®¾ç½®åº”ç”¨å›¾æ ‡...
   ğŸ“ æ‰¾åˆ°è®¾ç½®å›¾æ ‡ä½ç½®: (610, 1328)
âœ… è®¾ç½®åº”ç”¨å·²å¯åŠ¨

ğŸ“¸ æ­¥éª¤ 4: æˆªå–å±å¹•æˆªå›¾...
âœ… æˆªå›¾å·²ä¿å­˜åˆ°: ./settings_screenshot.png

â³æ­¥éª¤ 5: ç­‰å¾… 3 ç§’...
âœ… ç­‰å¾…å®Œæˆ

ğŸ›‘ æ­¥éª¤ 6: å…³é—­è®¾ç½®åº”ç”¨...
âœ… è®¾ç½®åº”ç”¨å·²å…³é—­

ğŸ  æ­¥éª¤ 7: è¿”å›ä¸»å±å¹•...
âœ… å·²è¿”å›ä¸»å±å¹•

ğŸ‰ æ¼”ç¤ºå®Œæˆï¼
```

---

## è„šæœ¬ 2: find-and-launch-app.sh

### åŠŸèƒ½ç‰¹ç‚¹

- âœ… æ”¯æŒæŸ¥æ‰¾ä»»æ„åº”ç”¨
- âœ… æ”¯æŒä¸­è‹±æ–‡åº”ç”¨åç§°
- âœ… æ™ºèƒ½æ»‘åŠ¨æŸ¥æ‰¾
- âœ… å¤šç§å¯åŠ¨æ–¹å¼ï¼ˆå›¾æ ‡ç‚¹å‡» / åŒ…åå¯åŠ¨ï¼‰
- âœ… çµæ´»çš„å‚æ•°é…ç½®

### ä½¿ç”¨æ–¹æ³•

```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x find-and-launch-app.sh

# åŸºæœ¬ç”¨æ³•
./find-and-launch-app.sh "åº”ç”¨åç§°" "åŒ…å"

# æŒ‡å®š Activityï¼ˆå¯é€‰ï¼‰
./find-and-launch-app.sh "åº”ç”¨åç§°" "åŒ…å" "Activityåç§°"
```

### ä½¿ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹ 1: å¯åŠ¨è®¾ç½®åº”ç”¨

```bash
./find-and-launch-app.sh "è®¾ç½®" "com.android.settings"
```

æˆ–ä½¿ç”¨è‹±æ–‡åç§°ï¼š

```bash
./find-and-launch-app.sh "Settings" "com.android.settings"
```

#### ç¤ºä¾‹ 2: å¯åŠ¨å¾®ä¿¡

```bash
./find-and-launch-app.sh "å¾®ä¿¡" "com.tencent.mm" ".ui.LauncherUI"
```

æˆ–ä½¿ç”¨è‹±æ–‡åç§°ï¼š

```bash
./find-and-launch-app.sh "WeChat" "com.tencent.mm" ".ui.LauncherUI"
```

#### ç¤ºä¾‹ 3: å¯åŠ¨ Chrome æµè§ˆå™¨

```bash
./find-and-launch-app.sh "Chrome" "com.android.chrome"
```

#### ç¤ºä¾‹ 4: å¯åŠ¨ç›¸æœº

```bash
./find-and-launch-app.sh "ç›¸æœº" "com.android.camera"
```

æˆ–ï¼š

```bash
./find-and-launch-app.sh "Camera" "com.android.camera"
```

#### ç¤ºä¾‹ 5: å¯åŠ¨æ”¯ä»˜å®

```bash
./find-and-launch-app.sh "æ”¯ä»˜å®" "com.eg.android.AlipayGphone" ".AlipayLogin"
```

#### ç¤ºä¾‹ 6: å¯åŠ¨æŠ–éŸ³

```bash
./find-and-launch-app.sh "æŠ–éŸ³" "com.ss.android.ugc.aweme" ".main.MainActivity"
```

### å¦‚ä½•è·å–åº”ç”¨ä¿¡æ¯

#### æ–¹æ³• 1: ä½¿ç”¨ ADB åˆ—å‡ºæ‰€æœ‰åº”ç”¨

```bash
# åˆ—å‡ºæ‰€æœ‰ç¬¬ä¸‰æ–¹åº”ç”¨
adb shell pm list packages -3

# åˆ—å‡ºæ‰€æœ‰ç³»ç»Ÿåº”ç”¨
adb shell pm list packages -s

# æœç´¢ç‰¹å®šåº”ç”¨
adb shell pm list packages | grep -i "å…³é”®è¯"
```

#### æ–¹æ³• 2: è·å–å½“å‰è¿è¡Œçš„åº”ç”¨

```bash
# è·å–å½“å‰å‰å°åº”ç”¨çš„åŒ…åå’Œ Activity
adb shell dumpsys window | grep -E 'mCurrentFocus|mFocusedApp'
```

ç¤ºä¾‹è¾“å‡ºï¼š
```
mCurrentFocus=Window{abc123 u0 com.android.settings/com.android.settings.Settings}
```

è¿™è¡¨ç¤ºï¼š
- åŒ…å: `com.android.settings`
- Activity: `.Settings`

#### æ–¹æ³• 3: ä½¿ç”¨ aapt å·¥å…·åˆ†æ APK

```bash
# è·å– APK è·¯å¾„
adb shell pm path com.example.app

# æ‹‰å– APK
adb pull /data/app/com.example.app-xxx/base.apk

# åˆ†æ APK
aapt dump badging base.apk | grep -E 'package|launchable-activity'
```

### å¸¸ç”¨åº”ç”¨åŒ…åå‚è€ƒ

| åº”ç”¨åç§° | åŒ…å | Activityï¼ˆå¯é€‰ï¼‰ |
|---------|------|-----------------|
| è®¾ç½® | com.android.settings | .Settings |
| ç›¸æœº | com.android.camera | - |
| ç›¸å†Œ | com.android.gallery3d | - |
| æµè§ˆå™¨ | com.android.browser | - |
| Chrome | com.android.chrome | - |
| å¾®ä¿¡ | com.tencent.mm | .ui.LauncherUI |
| QQ | com.tencent.mobileqq | .activity.SplashActivity |
| æ”¯ä»˜å® | com.eg.android.AlipayGphone | .AlipayLogin |
| æ·˜å® | com.taobao.taobao | .home.activity.MainActivity |
| æŠ–éŸ³ | com.ss.android.ugc.aweme | .main.MainActivity |
| å¿«æ‰‹ | com.smile.gifmaker | .HomeActivity |
| ç½‘æ˜“äº‘éŸ³ä¹ | com.netease.cloudmusic | .activity.MainActivity |
| QQéŸ³ä¹ | com.tencent.qqmusic | .activity.AppStarterActivity |

---

## é«˜çº§ç”¨æ³•

### 1. æ‰¹é‡å¯åŠ¨åº”ç”¨

åˆ›å»ºä¸€ä¸ªæ‰¹é‡å¯åŠ¨è„šæœ¬ï¼š

```bash
#!/bin/bash

# æ‰¹é‡å¯åŠ¨åº”ç”¨åˆ—è¡¨
apps=(
    "è®¾ç½®:com.android.settings"
    "ç›¸æœº:com.android.camera"
    "Chrome:com.android.chrome"
)

for app in "${apps[@]}"; do
    name=$(echo $app | cut -d: -f1)
    package=$(echo $app | cut -d: -f2)
    
    echo "å¯åŠ¨ $name..."
    ./find-and-launch-app.sh "$name" "$package"
    sleep 2
    
    # å…³é—­åº”ç”¨
    adb shell am force-stop $package
    sleep 1
done
```

### 2. åº”ç”¨å¯åŠ¨æ—¶é—´æµ‹è¯•

```bash
#!/bin/bash

APP_NAME="è®¾ç½®"
PACKAGE="com.android.settings"

echo "æµ‹è¯• $APP_NAME å¯åŠ¨æ—¶é—´..."

# è®°å½•å¼€å§‹æ—¶é—´
start_time=$(date +%s%N)

# å¯åŠ¨åº”ç”¨
./find-and-launch-app.sh "$APP_NAME" "$PACKAGE" > /dev/null 2>&1

# ç­‰å¾…åº”ç”¨å®Œå…¨å¯åŠ¨
sleep 2

# è®°å½•ç»“æŸæ—¶é—´
end_time=$(date +%s%N)

# è®¡ç®—è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
duration=$(( (end_time - start_time) / 1000000 ))

echo "å¯åŠ¨è€—æ—¶: ${duration}ms"
```

### 3. åº”ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•

```bash
#!/bin/bash

# å¯åŠ¨åº”ç”¨
./find-and-launch-app.sh "è®¾ç½®" "com.android.settings"

# ç­‰å¾…åŠ è½½
sleep 2

# æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œ
adb shell input tap 540 500    # ç‚¹å‡»æŸä¸ªé€‰é¡¹
sleep 1
adb shell input swipe 540 1000 540 300 300  # å‘ä¸Šæ»‘åŠ¨
sleep 1
adb shell input keyevent KEYCODE_BACK  # è¿”å›

# å…³é—­åº”ç”¨
adb shell am force-stop com.android.settings
```

### 4. å¾ªç¯æŸ¥æ‰¾ç›´åˆ°æ‰¾åˆ°

```bash
#!/bin/bash

APP_NAME="è®¾ç½®"
PACKAGE="com.android.settings"
MAX_ATTEMPTS=10

for i in $(seq 1 $MAX_ATTEMPTS); do
    echo "å°è¯• $i/$MAX_ATTEMPTS..."
    
    if ./find-and-launch-app.sh "$APP_NAME" "$PACKAGE" > /dev/null 2>&1; then
        echo "âœ… æˆåŠŸå¯åŠ¨åº”ç”¨"
        break
    else
        echo "âš ï¸  å¯åŠ¨å¤±è´¥ï¼Œé‡è¯•..."
        sleep 2
    fi
    
    if [ $i -eq $MAX_ATTEMPTS ]; then
        echo "âŒ è¾¾åˆ°æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œæ”¾å¼ƒ"
        exit 1
    fi
done
```

---

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: æ‰¾ä¸åˆ°åº”ç”¨å›¾æ ‡

**å¯èƒ½åŸå› :**
- åº”ç”¨åç§°ä¸åŒ¹é…
- åº”ç”¨ä¸åœ¨æ¡Œé¢ä¸Šï¼ˆåœ¨åº”ç”¨æŠ½å±‰ä¸­ï¼‰
- æ»‘åŠ¨æ¬¡æ•°ä¸å¤Ÿ

**è§£å†³æ–¹æ¡ˆ:**
```bash
# å¢åŠ æ»‘åŠ¨æ¬¡æ•°
# ç¼–è¾‘è„šæœ¬ï¼Œä¿®æ”¹ MAX_SWIPES=5 ä¸ºæ›´å¤§çš„å€¼

# æˆ–ç›´æ¥ä½¿ç”¨åŒ…åå¯åŠ¨
adb shell monkey -p com.example.app -c android.intent.category.LAUNCHER 1
```

### é—®é¢˜ 2: ç‚¹å‡»ä½ç½®ä¸å‡†ç¡®

**å¯èƒ½åŸå› :**
- å±å¹•åˆ†è¾¨ç‡ä¸åŒ
- UI å±‚çº§è§£æé”™è¯¯

**è§£å†³æ–¹æ¡ˆ:**
```bash
# æ‰‹åŠ¨æ£€æŸ¥åæ ‡
adb shell uiautomator dump /sdcard/window_dump.xml
adb pull /sdcard/window_dump.xml
cat window_dump.xml | grep -i "åº”ç”¨åç§°"

# æ‰‹åŠ¨æµ‹è¯•ç‚¹å‡»
adb shell input tap X Y
```

### é—®é¢˜ 3: åº”ç”¨å¯åŠ¨å¤±è´¥

**å¯èƒ½åŸå› :**
- åŒ…åé”™è¯¯
- Activity åç§°é”™è¯¯
- åº”ç”¨æœªå®‰è£…

**è§£å†³æ–¹æ¡ˆ:**
```bash
# æ£€æŸ¥åº”ç”¨æ˜¯å¦å®‰è£…
adb shell pm list packages | grep "åŒ…å"

# è·å–æ­£ç¡®çš„å¯åŠ¨ Activity
adb shell dumpsys package åŒ…å | grep -A 1 "android.intent.action.MAIN"

# ä½¿ç”¨ monkey å‘½ä»¤å¯åŠ¨ï¼ˆä¸éœ€è¦ Activityï¼‰
adb shell monkey -p åŒ…å -c android.intent.category.LAUNCHER 1
```

### é—®é¢˜ 4: æ»‘åŠ¨ä¸æµç•…

**å¯èƒ½åŸå› :**
- æ»‘åŠ¨é€Ÿåº¦å¤ªå¿«
- åŠ¨ç”»æœªå®Œæˆ

**è§£å†³æ–¹æ¡ˆ:**
```bash
# å¢åŠ æ»‘åŠ¨æ—¶é—´ï¼ˆä¿®æ”¹è„šæœ¬ä¸­çš„ 300 ä¸ºæ›´å¤§å€¼ï¼‰
adb shell input swipe X1 Y1 X2 Y2 500

# å¢åŠ ç­‰å¾…æ—¶é—´ï¼ˆä¿®æ”¹è„šæœ¬ä¸­çš„ sleep 1 ä¸º sleep 2ï¼‰
```

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ç¼“å­˜åº”ç”¨ä½ç½®**: è®°å½•å¸¸ç”¨åº”ç”¨çš„ä½ç½®ï¼Œä¸‹æ¬¡ç›´æ¥è·³è½¬
2. **å¹¶è¡Œå¤„ç†**: åŒæ—¶æ£€æŸ¥å¤šä¸ªé¡µé¢
3. **æ™ºèƒ½é¢„æµ‹**: æ ¹æ®ä½¿ç”¨é¢‘ç‡ä¼˜å…ˆæ£€æŸ¥æŸäº›é¡µé¢
4. **å‡å°‘ UI å¯¼å‡º**: åªåœ¨å¿…è¦æ—¶å¯¼å‡º UI å±‚çº§
5. **ä½¿ç”¨å¿«æ·æ–¹å¼**: å¯¹äºå¸¸ç”¨åº”ç”¨ï¼Œç›´æ¥ä½¿ç”¨åŒ…åå¯åŠ¨

---

## æ‰©å±•åŠŸèƒ½

### 1. æ·»åŠ æ—¥å¿—è®°å½•

```bash
LOG_FILE="app_launch.log"

echo "[$(date)] å¯åŠ¨åº”ç”¨: $APP_NAME" >> $LOG_FILE
./find-and-launch-app.sh "$APP_NAME" "$PACKAGE" 2>&1 | tee -a $LOG_FILE
```

### 2. æ·»åŠ é€šçŸ¥

```bash
# å¯åŠ¨æˆåŠŸåå‘é€é€šçŸ¥
if ./find-and-launch-app.sh "$APP_NAME" "$PACKAGE"; then
    osascript -e 'display notification "åº”ç”¨å¯åŠ¨æˆåŠŸ" with title "Android è‡ªåŠ¨åŒ–"'
fi
```

### 3. é›†æˆåˆ° CI/CD

```yaml
# .github/workflows/android-test.yml
name: Android App Test

on: [push]

jobs:
  test:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Android SDK
        uses: android-actions/setup-android@v2
      - name: Start Emulator
        run: |
          emulator -avd test_device &
          adb wait-for-device
      - name: Launch App
        run: ./find-and-launch-app.sh "MyApp" "com.example.myapp"
```

---

## æ€»ç»“

è¿™ä¸¤ä¸ªè„šæœ¬æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„ Android åº”ç”¨æŸ¥æ‰¾å’Œå¯åŠ¨åŠŸèƒ½ï¼š

- **demo-open-close-settings.sh**: å®Œæ•´çš„æ¼”ç¤ºè„šæœ¬ï¼Œå±•ç¤ºäº†ä»æŸ¥æ‰¾åˆ°å…³é—­çš„å®Œæ•´æµç¨‹
- **find-and-launch-app.sh**: é€šç”¨è„šæœ¬ï¼Œå¯ç”¨äºä»»æ„åº”ç”¨

é€šè¿‡ç»“åˆ ADBã€UI Automator å’Œæ™ºèƒ½æ»‘åŠ¨ç®—æ³•ï¼Œå¯ä»¥å¯é åœ°åœ¨ Android è®¾å¤‡ä¸Šå®šä½å¹¶å¯åŠ¨åº”ç”¨ï¼Œå¤§å¤§æé«˜äº†è‡ªåŠ¨åŒ–æµ‹è¯•å’Œæ—¥å¸¸æ“ä½œçš„æ•ˆç‡ã€‚
